<?xml version="1.0" encoding="utf-8"?>
<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
  <metadata>
    <id>ETCStorageHelper</id>
    <version>1.4.4</version>
    <title>ETC Storage Helper</title>
    <authors>Pablo - ETC Development Team</authors>
    <owners>Environmental Testing &amp; Consulting (ETC)</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <description>SharePoint storage abstraction for ETC desktop applications. Provides familiar File.ReadAllBytes/WriteAllBytes API that routes to SharePoint Online.</description>
    <releaseNotes>
      v1.4.4 - Large File Upload Fix (Bug Fix for v1.4.3)
      - FIXED: Large file uploads (>4MB) now use CancellationToken for timeout
      - Prevents "Properties can only be modified before sending the first request" error
      - HttpClient.Timeout is immutable after first use, now using per-operation cancellation
      - Chunked uploads work correctly with custom timeouts
      - No API changes - fully backward compatible
      
      v1.4.3 - HttpClient Connection Pooling Fix (Performance &amp; Stability)
      - FIXED: HttpClient now reused across requests instead of creating new instances
      - Eliminates TCP connection exhaustion that caused "connection closed" errors
      - Prevents port exhaustion on high-volume workloads
      - Significantly improves performance under load
      - Follows .NET HttpClient best practices
      - Auth tokens refreshed per-request (tokens can expire)
      - More stable for production use with concurrent operations
      - No API changes - fully backward compatible
      
      v1.4.2 - Path Normalization Fix (Bug Fix)
      - FIXED: Async directory methods now normalize paths consistently with sync methods
      - Prevents malformed paths when using Windows-style backslashes (e.g., "ClientA\\Job001")
      - Prevents double slashes from trailing slash inputs (e.g., "path//file.txt")
      - Fixed methods: GetFilesWithInfoAsync, GetFileSystemEntriesAsync, ExistsAsync, GetFolderUrlAsync
      - Ensures FullPath property in FileItemInfo is always well-formed
      - Sync and async methods now produce identical, consistent results
      - No API changes - fully backward compatible
      
      v1.4.1 - Enhanced Retry Policy (Bug Fix)
      - IMPROVED: Increased retry delays for better network error recovery
      - Initial retry delay: 2 seconds (was 1 second) - better for connection resets
      - Maximum retry delay: 60 seconds (was 30 seconds) - handles severe network issues
      - With 3 retries, total wait time: ~6 seconds (was ~3 seconds)
      - Exponential backoff: 2s → 4s → 8s (with jitter)
      - More resilient against transient network errors and connection drops
      - No API changes - fully backward compatible
      
      v1.4.0 - Overwrite Support for Move Operations (System.IO Compatibility)
      - NEW: Optional `overwrite` parameter for all Move operations
      - Mimics System.IO.File.Move() behavior (matches .NET Core 3.0+ functionality)
      - ETCFile.Move(source, dest, site, overwrite: true) - Overwrites if file exists
      - ETCDirectory.Move(source, dest, site, overwrite: true) - Overwrites if folder exists
      - ETCFileAsync.MoveAsync(..., overwrite: true) - Async version with overwrite
      - ETCDirectoryAsync.MoveAsync(..., overwrite: true) - Async version with overwrite
      - Default is overwrite: false (prevents accidental data loss, matches .NET Framework behavior)
      - Cross-site moves also support overwrite parameter
      - Fully backward compatible - existing Move() calls work unchanged
      
      v1.3.0 - Move and Rename Operations
      - NEW: ETCFile.Move() - Rename or move files within the same site
      - NEW: ETCFile.Move() overload - Move files between different sites
      - NEW: ETCFileAsync.MoveAsync() - Async version for background file moves
      - NEW: ETCDirectory.Move() - Rename or move folders (with all contents)
      - NEW: ETCDirectoryAsync.MoveAsync() - Async version for background folder moves
      - Enables renaming files/folders in place (e.g., "report.pdf" to "final_report.pdf")
      - Enables moving files/folders to different parent directories
      - All operations support callbacks for success/error handling
      - Fully backward compatible - all existing operations unchanged
      
      v1.2.0 - File Metadata and Sorting Support
      - NEW: ETCFileInfo class with file metadata (name, modified date, size, folder status)
      - NEW: ETCDirectory.GetFilesWithInfo() - Returns files with metadata for sorting
      - NEW: ETCDirectoryAsync.GetFilesWithInfoAsync() - Async version with metadata
      - Supports sorting by modified date, name, or size
      - Works with wildcard search patterns
      - Fully backward compatible - existing GetFiles() methods unchanged
      - Example: Sort files by modified date descending (newest first)
      
      v1.1.0 - Wildcard Search Pattern Support
      - NEW: Optional searchPattern parameter for ETCDirectory.GetFiles() and ETCDirectoryAsync.GetFilesAsync()
      - Supports wildcard patterns: * (any sequence) and ? (single character)
      - Examples: "*.pdf", "report*", "*.txt", "test?.txt"
      - Fully backward compatible - existing code continues to work unchanged
      - Case-insensitive pattern matching
      - Filter files by extension or name pattern without additional code
      
      v1.0.8 - Diagnostic Logging for Cloud Environments
      - Added console output showing which endpoints are being used
      - Helps debug authentication and Graph API issues in GCC High/DoD
      
      v1.0.7 - GCC High &amp; DoD Cloud Support
      - NEW: CloudEnvironment enum (Commercial, GCCHigh, DoD)
      - NEW: SharePointSite.Environment property to specify cloud environment
      - NEW: Automatic endpoint selection based on environment:
        * Commercial: graph.microsoft.com / login.microsoftonline.com
        * GCC High: graph.microsoft.us / login.microsoftonline.us
        * DoD: dod-graph.microsoft.us / login.microsoftonline.us
      - NEW: App.config support via ETCStorage.{prefix}.Environment setting
      - Enables same application to connect to both Commercial and GCC High tenants

      v1.0.6 - Network Resilience (Logger)
      - Enhanced: SharePointListLogger now uses proxy-aware HttpClient with TLS 1.2
      - Aligns logger HTTP behavior with file client to prevent send errors

      v1.0.5 - Network Resilience &amp; Proxy Support
      - Enhanced: HTTP client now honors system proxy with default credentials
      - Enhanced: Automatic decompression and TLS 1.2 enforced
      - Enhanced: Retry logs include inner exception details for diagnostics
      - Increased default HTTP timeout for downloads

      v1.0.4 - Bug Fixes and Auto-Repair
      - FIXED: SharePoint List Logger auto-detects and adds missing columns
      - FIXED: Large file upload timeout (dynamic calculation based on file size)
      - Enhanced: Auto-repair manually created SharePoint audit lists
      - Enhanced: Better error messages for configuration issues
      - Internal: Hardcoded audit log list name for consistency
      
      v1.0.3 - Complete Async Coverage
      - NEW: ETCDirectoryAsync class with full async directory operations
      - Added ETCFileAsync.ExistsAsync() for non-blocking existence checks
      - Added ETCFileAsync.CopyAsync() for background file copying
      - Added ETCFileAsync.GetFileUrlAsync() for async URL retrieval
      - Added ETCDirectoryAsync.CreateDirectoryAsync() for background folder creation
      - Added ETCDirectoryAsync.DeleteAsync() for background folder deletion
      - Added ETCDirectoryAsync.ExistsAsync(), GetFilesAsync(), GetDirectoriesAsync()
      - Added ETCDirectoryAsync.GetFolderUrlAsync() for async URL retrieval
      - All file and directory operations now have both sync and async versions
      - Enhanced documentation with complete async API coverage
      
      v1.0.2 - Complete Delete Operations
      - Added ETCDirectory.Delete() method (was missing)
      - Added ETCFileAsync.DeleteAsync() for background deletion
      - Enhanced documentation to clarify sync vs async behavior
      
      v1.0.1 - IntelliSense Support
      - Added XML documentation for IntelliSense support
      - Confirmed .NET Framework 4.6 compatibility
      
      v1.0.0 - Initial release
      - .NET Framework 4.6 compatible
      - File operations (ETCFile)
      - Directory operations (ETCDirectory)
      - Path utilities (ETCPath)
      - Azure AD authentication
      - SharePoint Graph API integration
    </releaseNotes>
    <copyright>Copyright © 2025 Environmental Testing &amp; Consulting</copyright>
    <tags>SharePoint Storage FileStorage ETC Azure</tags>
    <dependencies>
      <group targetFramework="net46">
        <dependency id="Newtonsoft.Json" version="13.0.3" />
      </group>
    </dependencies>
  </metadata>
  <files>
    <!-- Main assembly -->
    <file src="bin\Release\ETCStorageHelper.dll" target="lib\net46" />
    <file src="bin\Release\ETCStorageHelper.pdb" target="lib\net46" />
    <file src="bin\Release\ETCStorageHelper.xml" target="lib\net46" />
    
    <!-- Documentation -->
    <file src="README.md" target="" />
  </files>
</package>





















