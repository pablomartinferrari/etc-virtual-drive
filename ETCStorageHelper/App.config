<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <appSettings>
    <!-- 
    ============================================================================
    ETCStorageHelper - SharePoint Storage Configuration
    ============================================================================
    This file contains default configuration for the ETCStorageHelper library.
    
    Consuming applications can:
    1. Use these defaults by copying this config to their own app.config/web.config
    2. Override specific settings as needed
    3. Define multiple environments (Commercial, Dev, GCCHigh, etc.)
    
    IMPORTANT: Replace placeholder values with your actual Azure AD and SharePoint details
    ============================================================================
    -->

    <!-- 
    ============================================================================
    DEFAULT CONFIGURATION (ETCStorage.* keys)
    Used when calling: SharePointSite.FromConfig() without a specific prefix
    ============================================================================
    -->
    <add key="ETCStorage.TenantId" value="" />
    <add key="ETCStorage.ClientId" value="" />
    <add key="ETCStorage.ClientSecret" value="" />
    <add key="ETCStorage.SiteUrl" value="https://your-tenant.sharepoint.com/sites/your-site" />
    <add key="ETCStorage.LibraryName" value="Client Projects" />
    <add key="ETCStorage.TimeoutSeconds" value="60" />
    <add key="ETCStorage.RetryAttempts" value="3" />

    <!-- 
    ============================================================================
    EXAMPLE: COMMERCIAL ENVIRONMENT
    Used when calling: SharePointSite.FromConfig("Commercial", "ETCStorage.Commercial", ...)
    ============================================================================
    -->
    <add key="ETCStorage.Commercial.TenantId" value="" />
    <add key="ETCStorage.Commercial.ClientId" value="" />
    <add key="ETCStorage.Commercial.ClientSecret" value="" />
    <add key="ETCStorage.Commercial.SiteUrl" value="https://your-tenant.sharepoint.com/sites/commercial-projects" />
    <add key="ETCStorage.Commercial.LibraryName" value="Client Projects" />
    <add key="ETCStorage.Commercial.TimeoutSeconds" value="60" />
    <add key="ETCStorage.Commercial.RetryAttempts" value="3" />

    <!-- 
    ============================================================================
    EXAMPLE: DEVELOPMENT ENVIRONMENT
    Used when calling: SharePointSite.FromConfig("Development", "ETCStorage.Dev", ...)
    ============================================================================
    -->
    <add key="ETCStorage.Dev.TenantId" value="" />
    <add key="ETCStorage.Dev.ClientId" value="" />
    <add key="ETCStorage.Dev.ClientSecret" value="" />
    <add key="ETCStorage.Dev.SiteUrl" value="https://your-tenant.sharepoint.com/sites/dev-projects" />
    <add key="ETCStorage.Dev.LibraryName" value="Dev Projects" />
    <add key="ETCStorage.Dev.TimeoutSeconds" value="60" />
    <add key="ETCStorage.Dev.RetryAttempts" value="3" />

    <!-- 
    ============================================================================
    EXAMPLE: GCC HIGH ENVIRONMENT (Government Cloud)
    Used when calling: SharePointSite.FromConfig("GCCHigh", "ETCStorage.GCCHigh", ...)
    ============================================================================
    -->
    <add key="ETCStorage.GCCHigh.TenantId" value="" />
    <add key="ETCStorage.GCCHigh.ClientId" value="" />
    <add key="ETCStorage.GCCHigh.ClientSecret" value="" />
    <add key="ETCStorage.GCCHigh.SiteUrl" value="https://your-tenant.sharepoint.us/sites/secure-projects" />
    <add key="ETCStorage.GCCHigh.LibraryName" value="Secure Projects" />
    <add key="ETCStorage.GCCHigh.TimeoutSeconds" value="60" />
    <add key="ETCStorage.GCCHigh.RetryAttempts" value="3" />
  </appSettings>

  <!--
  ============================================================================
  CONFIGURATION KEYS REFERENCE
  ============================================================================
  
  TenantId          - Azure AD Tenant ID (GUID)
                      Find in: Azure Portal > Azure Active Directory > Properties
  
  ClientId          - Azure AD Application (Client) ID (GUID)
                      Find in: Azure Portal > App Registrations > Your App > Overview
  
  ClientSecret      - Azure AD Application Client Secret
                      Find in: Azure Portal > App Registrations > Your App > Certificates & secrets
                      SECURITY: Store securely, do not commit to source control
  
  SiteUrl           - Full SharePoint site URL
                      Example: https://contoso.sharepoint.com/sites/etc-projects
                      For GCC High: https://contoso.sharepoint.us/sites/...
  
  LibraryName       - Document library name (case-sensitive!)
                      Example: "Client Projects", "Documents", "Shared Documents"
                      Must match exactly as it appears in SharePoint
  
  TimeoutSeconds    - HTTP timeout for SharePoint operations (default: 60)
                      Increase for slow networks or large files
  
  RetryAttempts     - Number of retry attempts on failure (default: 3)
                      Handles transient network issues
  
  ============================================================================
  AUDIT LOGGING
  ============================================================================
  
  The library automatically creates an audit log in a SharePoint list named
  "ETC Storage Logs" on the same site specified in SiteUrl.
  
  This is handled internally by the library - you don't need to configure it.
  
  If the list doesn't exist, it will be created automatically.
  If the list exists but is missing required columns, they will be added.
  
  ============================================================================
  AZURE AD APP REGISTRATION REQUIREMENTS
  ============================================================================
  
  Your Azure AD app registration needs these Microsoft Graph API permissions:
  
  - Sites.ReadWrite.All (Application permission)
    For reading/writing files to SharePoint
  
  - Files.ReadWrite.All (Application permission)
    For file operations
  
  Grant admin consent for these permissions in Azure Portal.
  
  ============================================================================
  SECURITY BEST PRACTICES
  ============================================================================
  
  1. DO NOT commit ClientSecret values to source control
  2. Use Azure Key Vault or secure configuration for production
  3. Use different credentials for Dev/Test/Prod environments
  4. Rotate client secrets regularly
  5. Use least-privilege permissions
  
  ============================================================================
  -->
</configuration>
